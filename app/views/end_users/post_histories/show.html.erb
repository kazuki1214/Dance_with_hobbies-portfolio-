<div class="user-post">

  <%= link_to end_user_post_histories_path(@end_user) %><div class="post_back"><span class="post_back-span">⇦</span>投稿一覧に戻る</div><% end %>

  <%= render "user-post_histories/user-top", end_user: @end_user %>

  <div class="user-post_main">
    <div class="user-post_user">
      <%= link_to user_page_path(@post.end_user.id) do %>
        <%= attachment_image_tag @post.end_user, :user_image, size: "80x80", fallback: "no_image.jpg" %>
        <%=  @post.end_user.name %>
      <% end %>
      <div class="user-post_created">
        <%= @post.created_at, strftime("%Y/%m/%d/ %H:%M") %>
        <%= @post.hobby.title %>
      </div>
    </div>

    <h4 class="user-post_title"><%= @post.title %></h4>
    <%= attachment_image_tag @post, :post_image, class: "user-post_image" %>
    <div class="user-post_list">
      <% @post.tags.each do |t| %>
        <i class="fa-duotone fa-tag"><%= t.name %></i>
      <% end %>
    </div>
    <div class="user-post_body"><%= @post.body %></div>
  </div>
  <div class="user-post_sub">
    <div class="user-post_content">
      <h6><i class="fa-regular fa-eye"><%= @post.impressionist_count(:filter => :session_hash) %></i></h6>
      <h6 class="user-postt_post-comment">コメント<%= @post.comments.count %>件</h6>
      <div class="user-post_post-favorite" id="post-favorite-button-#{@post.id}">
        <% if favorite_posts?(end_user) %>
          <%= render "favorite_post/unpost-favorite", post: @post %>
        <% elsif %>
          <%= render "favorite_post/post-favorite", post: @post
        <% end %>
      </div>
    </div>
    <% @post.post_comments.each do |c| %>
      <div class="user-post_comment">
        <div class="user-post_comment-user">
          <%= link_to user_page_path(c.end_user.id) do %>
            <%= attachment_image_tag c.end_user, :user_image, size: "50x50", fallback: "no_image.jpg", format: "jpg" %>
            <%= c.end_user.name %>
          <% end %>
          <div class="user-post_comment-created">
            <%= c.created_at, strftime("%Y/%m/%d/ %H:%M") %>
          </div>
        </div>
        <div class="user-post_comment-main">
          <%= c.comment %>
        </div>
      </div>
    <% end %>
    <%= link_to hobby_post_post_comments_path(@post.hobby.id, @post.id) do %>
    <div class="user-post_all-comment">
      <p>コメント一覧へ</p>
    </div>
    <% end %>
  </div>

  <% if @post.end_user == current_end_user %>
    <%= link_to "投稿を削除する", end_user_post_history_path(@post.hobby.id, @post), class: "user-post_delete","data-confirm" => "投稿を削除しますか？", method: :delete %>
  <% end %>
</div>