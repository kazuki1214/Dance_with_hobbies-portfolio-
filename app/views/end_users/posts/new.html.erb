<div class="main">
  <%= render "layouts/navbar" %>
  <section class="new-post">

    <%= render 'end_users/hobbies/hobby-top', hobby: @hobby %>

    <h2>新規登録</h2>

    <%= form_with(model: [:end_users, @hobby, @new_post], url: confirm_hobby_posts_path(@hobby), local: true) do |f| %>
      <div class="new-post_main">
        <div class="new-post_title-field">
          <%= f.label :title, "題名:" %>
          <%= f.text_field :title, class: "new-post_field", placeholder:"タイトルを入力" %>
        </div>
        <div class="new-post_image-field">
          <%= f.attachment_field :post_image %>
          <%= attachment_image_tag @new_post, :post_image,size:"200x200", class: "new-post_image", format: "jpg", id:"post_img_prev" %>
        </div>
        <div class="new-post_tags">
          <%= f.label :tags, "タグ:(,で区切ると複数タグを登録でき、重複するタグは一つにまとまります)" %>
          <%= f.text_field :tags, class: "new-post_tag-field" %>
        </div>
        <div class="new-post_body">
          <%= f.label :body, "内容:" %>
          <%= f.text_area :body, class: "new-post_field", placeholder:"投稿内容を入力" %>
        </div>
      </div>
      <div class="new-post_send">
        <%= link_to "投稿をキャンセル", hobby_posts_path(@hobby.id), class: "new-post_cancel" %>
        <%= f.submit "投稿を確認する", class: "ml-md-5 new-post_submit" %>
      </div>
    <% end %>
  </section>
</div>

<script>
$(document).on("turbolinks:load", function(){
  function readURL(input) {
    if(input.files && input.files[0]){
      var reader = new FileReader();
      reader.onload = function (e) {
        $('#post_img_prev').attr('src', e.target.result);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }
  $("#post_post_image").change(function(){
    readURL(this);
  });
});

</script>