<div class="main">
  <%= render "layouts/navbar" %>
  <section class="user-edit">
    <%= form_with model:[:end_users, @user], url: end_user_path(@user), local: true do |f| %>
      <div class="user-edit_info">
        <h4><%= link_to "戻る", 'javascript:history.back()' %></h4>
        <%= link_to "ユーザー削除", withdraw_end_user_path(@user),class: "user-edit_delete-button", method: :patch, "data-confirm" => "本当に退会しますか？\n(ユーザーを削除しても投稿データは残ります)" %>
      </div>

      <div class="user-edit_image">
        <%= attachment_image_tag @user, :user_image, size:"150x150", fallback:"no_image.jpg", id:"user_img_prev" %>
        <%= f.attachment_field :user_image %>
      </div>

      <div class="user-edit_name">
        <%= f.label :name, "名前:", class:"user-edit_name-label" %>
        <%= f.text_field :name, class:"user-edit_name-field" %>
      </div>

      <div class="user-edit_comment">
        <%= f.label :user_comment, "紹介文:", class: "user-edit_comment-label" %>
        <%= f.text_area :user_comment, class:"user-edit_comment-field" %>
      </div>

      <div class="user-edit_complete">
        <h4><%= f.submit "更新", class:"user-edit_submit" %></h4>
      </div>

    <% end %>
  </section>
</div>

<script>
$(document).on("turbolinks:load", function(){
  function readURL(input) {
    if(input.files && input.files[0]){
      var reader = new FileReader();
      reader.onload = function (e) {
        $('#user_img_prev').attr('src', e.target.result);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }
  $("#end_user_user_image").change(function(){
    readURL(this);
  });
});
</script>