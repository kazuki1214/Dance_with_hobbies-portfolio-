<div class="main">
  <%= render "layouts/navbar" %>
  <section class="container">
    <%= form_with model: @user, local: true do |f| %>
      <div class="row">
        <%= link_to "戻る", 'javascript:history.back()' %>
        <%= f.submit "更新",  class:"ml-auto" %>
      </div>

      <div class="row mb-4">
        <%= attachment_image_tag @user, :user_image, size:"300x300", fallback: "no_image.jpg", id:"user_img_prev",  %>
        <%= f.attachment_field :user_image %>
      </div>
      <div class="row mb-4">
        <%= f.label :name, "名前:", class: "col-3 text-right" %>
        <%= f.text_field :name, class:"w-100 col-md-7 offset-md-1" %>
      </div>
      <div class="row mb-4">
        <%= f.label :email, "メールアドレス:", class: "col-3 text-right" %>
        <%= f.emil_field :email, class:"w-100 col-md-7 offset-md-1" %>
      </div>
      <div class="row mb-4">
        <%= f.label :user_comment, "紹介文:", class: "col-3 text-right" %>
        <%= f.text_area :user_comment, class:"w-100 col-md-7 offset-md-1 d-flex flex-wrap" %>
      </div>

    <% end %>

    <div class="row">
      <%= link_to "ユーザー削除", withdraw_end_user_path(@user), class: "user_withdraw mx-auto btn", "data-confirm" => "本当に退会しますか？\n(ユーザーを削除しても投稿データは残ります)" %>
    </div>
  </section>
</div>

<script>
$(document).on("turbolinks:load", function(){
  function readURL(input) {
    if(input.files && input.files[0]){
      var reader = new FileReader();
      reader.onload = function (e) {
        $('#user_img_prev').attr('src', e.target.result);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }
  $("#end_user_user_image").change(function(){
    readURL(this);
  });
});
</script>